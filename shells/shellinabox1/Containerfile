FROM alpine:3.17

RUN echo "@testing http://dl-cdn.alpinelinux.org/alpine/edge/testing" >> /etc/apk/repositories \
    && apk --no-cache add --no-cache shadow fuse-overlayfs podman curl bash vim shellinabox@testing \
    ;

RUN echo 'export PS1="\w \$ "' >> /root/.bashrc
RUN echo 'usermod --add-subuids 200000-201000 --add-subgids 200000-201000 root' >> /root/.bashrc

RUN echo "set bg=dark" > /root/.vimrc

ADD styles.css /data/

COPY dbash /usr/local/bin/dbash

EXPOSE 4200

CMD ["shellinaboxd", "--css", "/data/styles.css", "-s", "/:0:0:/root:/usr/local/bin/dbash", "--disable-ssl"]
